<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PromptHub 路 {{ title }}</title>
    <link rel="stylesheet" href="/static/global.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />
    <style>
        .editor-wrap{display:none;position:relative;margin-top:12px;border:1px solid var(--border);border-radius:12px;background:#0b1220;overflow:hidden}
        .editor-lines{position:absolute;inset:0 auto 0 0;width:3.2em;padding:12px 8px;text-align:right;color:#6b7280;user-select:none;pointer-events:none;white-space:pre;line-height:1.5}
        .editor-textarea{display:block;width:100%;height:280px;box-sizing:border-box;border:0;outline:0;resize:vertical;background:transparent;color:#e5e7eb;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;padding:12px 12px 12px calc(3.2em + 16px);line-height:1.5}
    </style>
</head>
<body class="theme-dark">
    <header class="site-header">
        <div class="container">
            <a class="gh-link gh-right" href="https://github.com/HiteshRock23/PromptHub" target="_blank" rel="noopener" aria-label="Project GitHub">
                <svg viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
            </a>
            <h1 class="brand"><a href="/hub/" class="brand-link" style="text-decoration:none;color:inherit">PromptHub</a></h1>
            <nav class="nav">
                <a href="/hub/" class="nav-link">Hub</a>
                <a href="/contribute/" class="nav-link">Contribute</a>
            </nav>
        </div>
    </header>

    <main class="container section" style="animation:fadeIn .3s ease-out both">
        <div class="detail-card" style="background:linear-gradient(180deg,#0d1117,#161b22);border:1px solid var(--border);border-radius:18px;box-shadow:0 18px 50px rgba(0,0,0,.35);padding:18px">
            <div class="detail-header" style="display:flex;justify-content:space-between;gap:12px;align-items:start">
                <div>
                    <h2 class="section-title" style="margin:0">{{ title }}</h2>
                    <p class="section-sub" id="detail-sub" style="margin:4px 0 8px">Language: XML 路 <span class="pill">Beginner</span> 路 <span class="pill">API</span></p>
                    <div class="meta" id="detail-badges">
                        <span class="pill">JavaScript</span>
                        <span class="pill">XML</span>
                        <span class="pill">Prompt</span>
                    </div>
                    <p class="section-sub" style="margin-top:8px">Added by <strong>@prompthub</strong> 路 2 days ago</p>
                </div>
                <div class="action-group" style="display:flex;gap:8px">
                    <button id="detail-copy" class="btn btn-primary" style="transform:translateZ(0)">Copy</button>
                    <button id="detail-edit" class="btn btn-secondary">Edit</button>
                </div>
            </div>
            <div class="code-wrap" style="position:relative;margin-top:12px">
                <button id="code-copy" class="icon-btn copy-top" aria-label="Copy code"></button>
                <pre class="line-numbers" style="margin:0;border:1px solid var(--border);border-radius:12px;overflow:auto;background:#0b1220"><code id="code-block" class="language-markup"></code></pre>
            </div>
            <div class="detail-actions" style="display:flex;gap:8px;margin-top:10px;justify-content:flex-end">
                <button id="detail-up" class="rating-btn rating-btn--up" aria-label="Helpful" title="Helpful">
                    <span class="rating-icon"></span>
                    <span id="detail-up-count" class="rating-count"></span>
                </button>
                <button id="detail-down" class="rating-btn rating-btn--down" aria-label="Not Helpful" title="Not Helpful">
                    <span class="rating-icon"></span>
                    <span id="detail-down-count" class="rating-count"></span>
                </button>
            </div>
            <div id="detail-editor-wrap" class="editor-wrap">
                <button id="detail-editor-copy" class="icon-btn copy-top" aria-label="Copy edited code"></button>
                <div id="detail-editor-lines" class="editor-lines" aria-hidden="true"></div>
                <textarea id="detail-editor" class="editor-textarea" spellcheck="false"></textarea>
            </div>
        </div>

        <section class="section" style="padding-top:18px">
            <h3 class="section-title">Related Prompts</h3>
            <p class="section-sub">Coming soon: suggestions based on tags and categories.</p>
        </section>
    </main>

    <footer class="site-footer">
        <div class="footer">
            <div class="container footer-inner">
                <div class="footer-left">
                    <a href="/hub/" class="footer-brand-name">PromptHub</a>
                    <div class="footer-copy">漏 <span id="year"></span></div>
                </div>
                <div class="footer-center">MIT License 路 Open Source</div>
                <nav class="footer-right" aria-label="Footer">
                    <a class="footer-link" href="/hub/">Browse Prompts</a>
                    <a class="footer-link" target="_blank" rel="noopener" href="https://github.com/HiteshRock23/PromptHub/blob/main/CONTRIBUTING.md">Contribute</a>
                    <a class="footer-icon" target="_blank" rel="noopener" href="https://github.com/HiteshRock23/PromptHub" aria-label="GitHub Repository">
                        <svg viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
                    </a>
                </nav>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <script src="/static/vote.js?v=1"></script>
    <script>
        document.getElementById('year').textContent = new Date().getFullYear();
        const code = document.getElementById('code-block');
        const copyBtn = document.getElementById('detail-copy');
        const editBtn = document.getElementById('detail-edit');
        const editorWrap = document.getElementById('detail-editor-wrap');
        const editor = document.getElementById('detail-editor');
        const lines = document.getElementById('detail-editor-lines');
        const codeCopy = document.getElementById('code-copy');

        // Inject content into Prism block
        code.textContent = `{{ content|escapejs }}`;
        if(window.Prism){ Prism.highlightElement(code); }

        const copyContent = async (text, btn) => {
            try{
                await navigator.clipboard.writeText(text);
                const isIcon = btn.classList.contains('icon-btn');
                btn.textContent = isIcon ? '锔' : 'Copied!';
                setTimeout(()=> btn.textContent = isIcon ? '' : 'Copy', 900);
            }catch(e){}
        };

        copyBtn.addEventListener('click', ()=> copyContent(code.textContent, copyBtn));
        codeCopy.addEventListener('click', ()=> copyContent(code.textContent, codeCopy));

        function updateLineNumbers(){
            const count = (editor.value.match(/\n/g) || []).length + 1;
            let out = '';
            for(let i=1;i<=count;i++){ out += i + (i===count?'':'\n'); }
            lines.textContent = out;
        }

        editor.addEventListener('input', updateLineNumbers);
        editor.addEventListener('scroll', ()=>{
            lines.style.transform = `translateY(${-editor.scrollTop}px)`;
        });

        const editorCopy = document.getElementById('detail-editor-copy');
        if(editorCopy){ editorCopy.addEventListener('click', ()=> copyContent(editor.value, editorCopy)); }

        editBtn.addEventListener('click', ()=>{
            if(editorWrap.style.display==='none'){
                editor.value = code.textContent;
                editorWrap.style.display='block';
                editBtn.textContent='Close Edit';
                updateLineNumbers();
                try { editor.setSelectionRange(0, 0); } catch(_) {}
                editor.scrollTop = 0;
            } else {
                editorWrap.style.display='none';
                editBtn.textContent='Edit';
            }
        });

        // Rating feedback with counts (persisted, synced with cards) via shared module
        const upBtn = document.getElementById('detail-up');
        const downBtn = document.getElementById('detail-down');
        const upCountEl = document.getElementById('detail-up-count');
        const downCountEl = document.getElementById('detail-down-count');
        const pid = String({{ pid|default:'0' }});
        if(window.wireVoteControls){
            window.wireVoteControls({
                pid,
                upBtn,
                downBtn,
                upCountEl,
                downCountEl
            });
        }
    </script>
</body>
</html>


